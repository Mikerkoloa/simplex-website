<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SimPlexæ¢æ¸¬å™¨äºŒé€²åˆ¶è‡ªå‹•è¨ˆç®—</title>
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 10px;
            background-color: #f5f5f5;
        }
        
        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }
        
        .input-section {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .input-section label {
            font-size: 16px;
            font-weight: bold;
            color: #555;
            display: block;
            margin-bottom: 10px;
        }
        
        .input-controls {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 10px;
        }
        
        .input-section input {
            font-size: 20px;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            width: 150px;
            text-align: center;
            min-width: 120px;
        }
        
        .input-section button {
            font-size: 16px;
            padding: 12px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            white-space: nowrap;
        }
        
        .input-section button:hover {
            background-color: #0056b3;
        }
        
        .clear-history {
            background-color: #dc3545;
            font-size: 14px;
            padding: 8px 16px;
        }
        
        .clear-history:hover {
            background-color: #c82333;
        }
        
        .result-section {
            display: none;
            margin-top: 20px;
        }
        
        .dip-switches {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin: 20px 0;
        }
        
        .switch-group {
            text-align: center;
            padding: 15px;
            border: 2px solid #333;
            border-radius: 10px;
            background-color: #f8f9fa;
        }
        
        .switch-group h3 {
            margin-top: 0;
            margin-bottom: 15px;
            color: #333;
            font-size: 1.2rem;
        }
        
        .switches {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        
        .switch {
            width: 50px;
            height: 70px;
            border: 2px solid #333;
            border-radius: 5px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            padding: 5px;
            background-color: white;
            min-width: 45px;
        }
        
        .switch-number {
            font-size: 12px;
            font-weight: bold;
        }
        
        .switch-position {
            width: 35px;
            height: 25px;
            border-radius: 3px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            font-size: 12px;
        }
        
        .switch-on {
            background-color: #28a745;
        }
        
        .switch-off {
            background-color: #dc3545;
        }
        
        .binary-display {
            font-size: 20px;
            font-weight: bold;
            color: #333;
            margin: 10px 0;
        }
        
        .info {
            background-color: #e7f3ff;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            font-size: 14px;
        }
        
        .error {
            background-color: #ffe7e7;
            color: #d63384;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            display: none;
        }
        
        .history-section {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
        }
        
        .history-section h3 {
            margin-top: 0;
            color: #333;
            font-size: 1.1rem;
        }
        
        .history-list {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .history-item {
            background: white;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 10px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
            font-size: 14px;
        }
        
        .history-item:hover {
            background-color: #e9ecef;
        }
        
        .history-item-header {
            font-weight: bold;
            color: #007bff;
            margin-bottom: 5px;
        }
        
        .history-item-details {
            color: #666;
            font-size: 12px;
        }
        
        .no-history {
            text-align: center;
            color: #666;
            font-style: italic;
            padding: 20px;
        }
        
        /* å¹³æ¿éŸ¿æ‡‰å¼è¨­è¨ˆ */
        @media (min-width: 768px) {
            body {
                padding: 20px;
            }
            
            .container {
                padding: 30px;
            }
            
            .main-content {
                grid-template-columns: 2fr 1fr;
            }
            
            .dip-switches {
                flex-direction: row;
                gap: 30px;
            }
            
            .switch {
                width: 45px;
                height: 65px;
            }
            
            .binary-display {
                font-size: 24px;
            }
        }
        
        /* æ¡Œé¢éŸ¿æ‡‰å¼è¨­è¨ˆ */
        @media (min-width: 1024px) {
            h1 {
                font-size: 2rem;
            }
            
            .input-section label {
                font-size: 18px;
            }
            
            .input-section input {
                font-size: 24px;
                width: 180px;
            }
            
            .input-section button {
                font-size: 18px;
                padding: 12px 24px;
            }
            
            .switch-group h3 {
                font-size: 1.3rem;
            }
        }
        
        /* å°è¢å¹•å„ªåŒ– */
        @media (max-width: 480px) {
            .container {
                padding: 15px;
                margin: 5px;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            .input-controls {
                flex-direction: column;
            }
            
            .input-section input {
                width: 100%;
                max-width: 200px;
            }
            
            .input-section button {
                width: 100%;
                max-width: 200px;
            }
            
            .switch {
                width: 40px;
                height: 60px;
            }
            
            .switch-position {
                width: 30px;
                height: 20px;
                font-size: 10px;
            }
            
            .binary-display {
                font-size: 18px;
            }
            
            .switches {
                gap: 5px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>SimPlexæ¢æ¸¬å™¨äºŒé€²åˆ¶è‡ªå‹•è¨ˆç®—<</h1>
        
        <div class="main-content">
            <div class="calculator-section">
                <div class="input-section">
                    <label for="addressInput">è«‹è¼¸å…¥åœ°å€è™Ÿç¢¼ (0-255)ï¼š</label>
                    <div class="input-controls">
                        <input type="number" id="addressInput" min="0" max="255" placeholder="ä¾‹å¦‚: 125">
                        <button onclick="calculateDipSwitches()">è¨ˆç®—è¨­å®š</button>
                        <button class="clear-history" onclick="clearHistory()">æ¸…é™¤æ­·å²</button>
                    </div>
                </div>
                
                <div class="error" id="errorMessage"></div>
                
                <div class="result-section" id="resultSection">
                    <h2 style="text-align: center; color: #333;">DIPé–‹é—œè¨­å®šçµæœ</h2>
                    
                    <div class="info">
                        <strong>åœ°å€è™Ÿç¢¼ï¼š</strong> <span id="addressNumber"></span><br>
                        <strong>8ä½äºŒé€²åˆ¶ï¼š</strong> <span id="binaryFull"></span>
                    </div>
                    
                    <div class="dip-switches">
                        <div class="switch-group">
                            <h3>1~4è™Ÿé–‹é—œ (LSB)</h3>
                            <div class="switches" id="switches1to4"></div>
                            <div class="binary-display" id="binary1to4"></div>
                        </div>
                        
                        <div class="switch-group">
                            <h3>5~8è™Ÿé–‹é—œ (MSB)</h3>
                            <div class="switches" id="switches5to8"></div>
                            <div class="binary-display" id="binary5to8"></div>
                        </div>
                    </div>
                    
                    <div class="info">
                        <strong>è¨­å®šèªªæ˜ï¼š</strong><br>
                        â€¢ é–‹é—œå‘ä¸Š(ON) = 1<br>
                        â€¢ é–‹é—œå‘ä¸‹(OFF) = 0<br>
                        â€¢ ç¶ è‰² = ON (1)ï¼Œç´…è‰² = OFF (0)
                    </div>
                </div>
            </div>
            
            <div class="history-section">
                <h3>ğŸ“‹ è¨ˆç®—æ­·å²</h3>
                <div class="history-list" id="historyList">
                    <div class="no-history">å°šç„¡è¨ˆç®—è¨˜éŒ„</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ­·å²è¨˜éŒ„å­˜å„²
        let calculationHistory = [];
        
        // å¾localStorageè¼‰å…¥æ­·å²è¨˜éŒ„
        function loadHistory() {
            const saved = localStorage.getItem('dipSwitchHistory');
            if (saved) {
                calculationHistory = JSON.parse(saved);
                updateHistoryDisplay();
            }
        }
        
        // ä¿å­˜æ­·å²è¨˜éŒ„åˆ°localStorage
        function saveHistory() {
            localStorage.setItem('dipSwitchHistory', JSON.stringify(calculationHistory));
        }
        
        function calculateDipSwitches() {
            const input = document.getElementById('addressInput');
            const address = parseInt(input.value);
            const errorDiv = document.getElementById('errorMessage');
            const resultDiv = document.getElementById('resultSection');
            
            // æ¸…é™¤ä¹‹å‰çš„éŒ¯èª¤è¨Šæ¯
            errorDiv.style.display = 'none';
            
            // é©—è­‰è¼¸å…¥
            if (isNaN(address) || address < 0 || address > 255) {
                errorDiv.textContent = 'è«‹è¼¸å…¥æœ‰æ•ˆçš„åœ°å€è™Ÿç¢¼ (0-255)';
                errorDiv.style.display = 'block';
                resultDiv.style.display = 'none';
                return;
            }
            
            // è½‰æ›ç‚º8ä½äºŒé€²åˆ¶
            const binary = address.toString(2).padStart(8, '0');
            
            // åˆ†å‰²ç‚ºå…©çµ„ (LSB 1-4, MSB 5-8)
            const lsb = binary.slice(4, 8); // å¾Œ4ä½ (1-4è™Ÿ)
            const msb = binary.slice(0, 4); // å‰4ä½ (5-8è™Ÿ)
            
            // æ›´æ–°é¡¯ç¤º
            document.getElementById('addressNumber').textContent = address;
            document.getElementById('binaryFull').textContent = binary;
            document.getElementById('binary1to4').textContent = lsb;
            document.getElementById('binary5to8').textContent = msb;
            
            // ç”Ÿæˆé–‹é—œè¦–è¦ºåŒ–
            generateSwitches('switches1to4', lsb, [1, 2, 3, 4]);
            generateSwitches('switches5to8', msb, [5, 6, 7, 8]);
            
            // æ·»åŠ åˆ°æ­·å²è¨˜éŒ„
            addToHistory(address, binary, lsb, msb);
            
            // é¡¯ç¤ºçµæœ
            resultDiv.style.display = 'block';
        }
        
        function addToHistory(address, binary, lsb, msb) {
            const timestamp = new Date().toLocaleString('zh-TW');
            
            // æª¢æŸ¥æ˜¯å¦å·²å­˜åœ¨ç›¸åŒçš„åœ°å€
            const existingIndex = calculationHistory.findIndex(item => item.address === address);
            
            const historyItem = {
                address: address,
                binary: binary,
                lsb: lsb,
                msb: msb,
                timestamp: timestamp
            };
            
            if (existingIndex !== -1) {
                // æ›´æ–°ç¾æœ‰è¨˜éŒ„çš„æ™‚é–“æˆ³
                calculationHistory[existingIndex] = historyItem;
            } else {
                // æ·»åŠ æ–°è¨˜éŒ„åˆ°é–‹é ­
                calculationHistory.unshift(historyItem);
            }
            
            // é™åˆ¶æ­·å²è¨˜éŒ„æ•¸é‡ç‚º20ç­†
            if (calculationHistory.length > 20) {
                calculationHistory = calculationHistory.slice(0, 20);
            }
            
            saveHistory();
            updateHistoryDisplay();
        }
        
        function updateHistoryDisplay() {
            const historyList = document.getElementById('historyList');
            
            if (calculationHistory.length === 0) {
                historyList.innerHTML = '<div class="no-history">å°šç„¡è¨ˆç®—è¨˜éŒ„</div>';
                return;
            }
            
            historyList.innerHTML = '';
            
            calculationHistory.forEach((item, index) => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                historyItem.onclick = () => loadFromHistory(item);
                
                historyItem.innerHTML = `
                    <div class="history-item-header">åœ°å€ ${item.address}</div>
                    <div class="history-item-details">
                        äºŒé€²åˆ¶: ${item.binary}<br>
                        1-4è™Ÿ: ${item.lsb} | 5-8è™Ÿ: ${item.msb}<br>
                        æ™‚é–“: ${item.timestamp}
                    </div>
                `;
                
                historyList.appendChild(historyItem);
            });
        }
        
        function loadFromHistory(item) {
            document.getElementById('addressInput').value = item.address;
            calculateDipSwitches();
        }
        
        function clearHistory() {
            if (confirm('ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰æ­·å²è¨˜éŒ„å—ï¼Ÿ')) {
                calculationHistory = [];
                localStorage.removeItem('dipSwitchHistory');
                updateHistoryDisplay();
            }
        }
        
        function generateSwitches(containerId, binaryString, switchNumbers) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            for (let i = 0; i < 4; i++) {
                const bit = binaryString[i];
                const switchDiv = document.createElement('div');
                switchDiv.className = 'switch';
                
                const numberDiv = document.createElement('div');
                numberDiv.className = 'switch-number';
                numberDiv.textContent = switchNumbers[i];
                
                const positionDiv = document.createElement('div');
                positionDiv.className = 'switch-position';
                
                if (bit === '1') {
                    positionDiv.className += ' switch-on';
                    positionDiv.textContent = 'ON';
                } else {
                    positionDiv.className += ' switch-off';
                    positionDiv.textContent = 'OFF';
                }
                
                switchDiv.appendChild(numberDiv);
                switchDiv.appendChild(positionDiv);
                container.appendChild(switchDiv);
            }
        }
        
        // å…è¨±æŒ‰Enteréµè¨ˆç®—
        document.getElementById('addressInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                calculateDipSwitches();
            }
        });
        
        // é é¢è¼‰å…¥æ™‚è¼‰å…¥æ­·å²è¨˜éŒ„ä¸¦è‡ªå‹•è¨ˆç®—125çš„ä¾‹å­
        window.onload = function() {
            loadHistory();
            document.getElementById('addressInput').value = 125;
            calculateDipSwitches();
        };
    </script>
</body>
</html>


